
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1.5. Shortest Paths and Dijkstra’s Algorithm &#8212; Graph Theory</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/admonition.css" />
    <link rel="stylesheet" type="text/css" href="../_static/dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"C": "\\mathbb{C}", "FF": "\\mathbb{F}", "N": "\\mathbb{N}", "Ns": "\\mathbb{N^\\ast}", "Q": "\\mathbb{Q}", "R": "\\mathbb{R}", "Span": ["\\mathop{\\mathrm{span}}"], "Z": "\\mathbb{Z}", "abs": ["\\left\\lvert #1 \\right\\rvert", 1], "argmax": ["\\mathop{\\mathrm{arg \\, max}}"], "argmin": ["\\mathop{\\mathrm{arg \\, min}}"], "bmat": ["\\left[\\begin{array}"], "brk": ["\\left( #1 \\right)", 1], "col": ["\\mathop{\\mathrm{col}}"], "d": ["\\mathrm{d}"], "emat": ["\\end{array}\\right]"], "floor": ["\\lfloor#1\\rfloor", 1], "im": ["\\mathop{\\mathrm{im}}"], "ind": ["\\mathbb{1}"], "ker": ["\\mathop{\\mathrm{ker}}"], "lowint": ["\\underline{\\int}"], "norm": ["\\left\\lVert #1 \\right\\rVert", 1], "odv": ["\\frac{\\mathrm{d} #1s}{\\mathrm{d} #2}", 2], "odvs": ["\\frac{\\mathrm{d}}{\\mathrm{d} #2} #1", 2], "row": ["\\mathop{\\mathrm{row}}"], "set": ["\\left\\{ #1 \\middle| #2 \\right\\}", 2], "upint": ["\\overline{\\int}"], "v": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Trees" href="../Trees/index.html" />
    <link rel="prev" title="1.4. Cycles" href="Cycles.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Graph Theory</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Main Contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   1. Basic Concepts of Graphs
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Isomorphism.html">
     1.1. Isomorphism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Vertex%20Degrees.html">
     1.2. Vertex Degrees
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Paths%20and%20Connection.html">
     1.3. Paths and Connection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Cycles.html">
     1.4. Cycles
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1.5. Shortest Paths and Dijkstra’s Algorithm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../Trees/index.html">
   2. Trees
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Trees/Definition%20of%20Trees.html">
     2.1. Definition of Trees
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Isaac-Fate/graph-theory"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Isaac-Fate/graph-theory/issues/new?title=Issue%20on%20page%20%2FBasic Concepts of Graphs/Shortest Paths and Dijkstra's Algorithm.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Basic Concepts of Graphs/Shortest Paths and Dijkstra's Algorithm.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-first-attempt">
   1.5.1. A First Attempt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dijkstra-s-algorithm">
   1.5.2. Dijkstra’s Algorithm
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Shortest Paths and Dijkstra’s Algorithm</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-first-attempt">
   1.5.1. A First Attempt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dijkstra-s-algorithm">
   1.5.2. Dijkstra’s Algorithm
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="shortest-paths-and-dijkstra-s-algorithm">
<span id="index-0"></span><h1><span class="section-number">1.5. </span>Shortest Paths and Dijkstra’s Algorithm<a class="headerlink" href="#shortest-paths-and-dijkstra-s-algorithm" title="Permalink to this headline">#</a></h1>
<p>With every edge <span class="math notranslate nohighlight">\(e\)</span> in graph <span class="math notranslate nohighlight">\(G\)</span>, we can associate a real number <span class="math notranslate nohighlight">\(w(e)\)</span>, usually positive, which we shall call the <strong>weight</strong> of that edge. As we will see, to unify our notations for some special cases, it is convenient to define the weight of a nonexistent edge between two non-incident vertices as infinity <span class="math notranslate nohighlight">\(\infty\)</span>.</p>
<p>We can now extend our former definition of the length of a path by</p>
<div class="math notranslate nohighlight">
\[\begin{align*}\abs{P} := \sum_{e \in P} w(e)
\end{align*}\]</div>
<p>Note that if all the edges are assigned to unit weights, then <span class="math notranslate nohighlight">\(\abs{P}\)</span> is just the number of edges in it, which reduces to the former definition. Notice also that the length of a trivial path is also zero since the sum of nothing in the above equation, by convention, is zero.</p>
<p>Given a map, the cities can be regarded as vertices, and for each pair of adjacent cities, we can draw an edge in between them. In this example, it is reasonable to define the weight of edge <span class="math notranslate nohighlight">\(uv\)</span> as the distance between cities <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>. Then the problem of finding a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(v\)</span> arises quite naturally if we want to travel from city <span class="math notranslate nohighlight">\(u_0\)</span>(where we live) to every other city <span class="math notranslate nohighlight">\(v\)</span> at the minimum cost.</p>
<p>Formally, for all <span class="math notranslate nohighlight">\(u, v \in V\)</span>, the length of the shortest path from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
d(u,v) :=
\begin{cases}
\min \set{\abs{P}}{\text{$P$ is a $(u, v)$-path}} ,
&amp;\text{if $u$ and $v$ are connected} \\
\infty,
&amp;\text{if $u$ and $v$ are disconnected}
\end{cases}\end{align*}\end{split}\]</div>
<p>Given a proper subset <span class="math notranslate nohighlight">\(S\)</span> of <span class="math notranslate nohighlight">\(V\)</span> and a source <span class="math notranslate nohighlight">\(u_0 \in S\)</span> in it, it is natural to define the distance from <span class="math notranslate nohighlight">\(u_0\)</span> to the complement <span class="math notranslate nohighlight">\(S^\complement\)</span> as the minimum distance from <span class="math notranslate nohighlight">\(u_0\)</span> to every <span class="math notranslate nohighlight">\(v \in S^\complement\)</span>, that is,</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
d(u_0, S^\complement) := \min_{v \in S^\complement} d(u_0, v)
\end{align*}\]</div>
<p>Of course, if <span class="math notranslate nohighlight">\(d(u_0, S^\complement) = \infty\)</span>, then there are no paths from <span class="math notranslate nohighlight">\(u_0\)</span> to any vertex in <span class="math notranslate nohighlight">\(S^\complement\)</span>, in other words, <span class="math notranslate nohighlight">\(u_0\)</span> is disconnected from <span class="math notranslate nohighlight">\(S^\complement\)</span>. Suppose <span class="math notranslate nohighlight">\(d(u_0, S^\complement)\)</span> is a finite number, which means there exists a path <span class="math notranslate nohighlight">\(P = u_0 \cdots u v\)</span> from <span class="math notranslate nohighlight">\(u_0\)</span> to some vertex <span class="math notranslate nohighlight">\(v \in S^\complement\)</span>. The following are some simple observations about this path <span class="math notranslate nohighlight">\(P\)</span>:</p>
<ul class="simple">
<li><p>➀ <span class="math notranslate nohighlight">\(P\)</span> is a shortest <span class="math notranslate nohighlight">\((u_0, v)\)</span>-path,</p></li>
<li><p>➁ <span class="math notranslate nohighlight">\(u \in S\)</span> and the <span class="math notranslate nohighlight">\((u_0, u)\)</span>-section, <span class="math notranslate nohighlight">\(u_0 \cdots u\)</span>, is a shortest <span class="math notranslate nohighlight">\((u_0, u)\)</span>-path, and</p></li>
<li><p>➂ we have the equation</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-9">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-eq-9" title="Permalink to this equation">#</a></span>\[\begin{align}
d(u_0, S^\complement) = d(u_0, u) + w(uv)
\end{align}\]</div>
<p>Equation <a class="reference internal" href="#equation-eq-9">(1.4)</a> motivates us to state the following proposition, which is the central idea of Dijkstra’s algorithm.</p>
<div class="proof proposition admonition" id="pro:2">
<p class="admonition-title"><span class="caption-number">Proposition 1.7 </span></p>
<div class="proposition-content section" id="proof-content">
<p>Let <span class="math notranslate nohighlight">\(G = (V, E)\)</span> be a simple graph. Let <span class="math notranslate nohighlight">\(S \subseteq V\)</span> be a subset of vertices and <span class="math notranslate nohighlight">\(u_0 \in S\)</span> a point in it. We have</p>
<div class="math notranslate nohighlight" id="equation-eq-5">
<span class="eqno">(1.5)<a class="headerlink" href="#equation-eq-5" title="Permalink to this equation">#</a></span>\[\begin{align}
d(u_0, S^\complement)
= \min_{u \in S, v \in S^\complement}\{
d(u_0, u) + w(u v)
\}\end{align}\]</div>
</div>
</div><div class="proof admonition" id="proof">
<p>Proof. First, note that the set</p>
<div class="math notranslate nohighlight">
\[\begin{align*}\set{d(u_0, u) + w(u v)}{u \in S, v \in S^\complement}\end{align*}\]</div>
<p>is a finite set (possibly containing infinite numbers). Hence, it does have a minimum.</p>
<p>Assume there exist <span class="math notranslate nohighlight">\(u^\ast \in S\)</span> and <span class="math notranslate nohighlight">\(v^\ast \in S^\complement\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-eq-4">
<span class="eqno">(1.6)<a class="headerlink" href="#equation-eq-4" title="Permalink to this equation">#</a></span>\[\begin{align}
d(u_0, S^\complement)
&gt; d(u_0, u^\ast) + w(u^\ast v^\ast)
\end{align}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that <a class="reference internal" href="#equation-eq-4">(1.6)</a> implicitly implies that <span class="math notranslate nohighlight">\(u_0\)</span> and <span class="math notranslate nohighlight">\(u^\ast\)</span> are connected and <span class="math notranslate nohighlight">\(u^\ast\)</span> and <span class="math notranslate nohighlight">\(v^\ast\)</span> are connected since the right-hand side of <a class="reference internal" href="#equation-eq-4">(1.6)</a> is a finite number.</p>
</div>
<p>Then there exists a <span class="math notranslate nohighlight">\((u_0, u^\ast)\)</span>-path <span class="math notranslate nohighlight">\(P\)</span> such that <span class="math notranslate nohighlight">\(\abs{P} = d(u_0, u^\ast)\)</span>. Note that <span class="math notranslate nohighlight">\(P v^\ast\)</span> forms a path since all vertices in <span class="math notranslate nohighlight">\(P\)</span> are in <span class="math notranslate nohighlight">\(S\)</span> while <span class="math notranslate nohighlight">\(v^\ast\)</span> is in the complement <span class="math notranslate nohighlight">\(S^\ast\)</span>. But <span class="math notranslate nohighlight">\(P v^\ast\)</span> is a path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(S^\complement\)</span> with length <span class="math notranslate nohighlight">\(d(u_0, u^\ast) + w(u^\ast v^\ast)\)</span>, which is less than <span class="math notranslate nohighlight">\(d(u_0, S^\complement)\)</span> by assumption. Therefore, this leads to a contradiction. We have</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
d(u_0, S^\complement)
\leq d(u_0, u) + w(u v)
\quad\forall u \in S \;\forall v \in S^\complement\end{align*}\]</div>
<p>And <a class="reference internal" href="#equation-eq-5">(1.5)</a> is proved.</p>
</div>
<div class="section" id="a-first-attempt">
<h2><span class="section-number">1.5.1. </span>A First Attempt<a class="headerlink" href="#a-first-attempt" title="Permalink to this headline">#</a></h2>
<p>Starting from an initial set <span class="math notranslate nohighlight">\(S^{(0)} = \{u_0\}\)</span> containing just the source, we want to enlarge this set in a way that a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to any vertex within the set is known. Given <span class="math notranslate nohighlight">\(S^{(j-1)}\)</span>, in each iteration <span class="math notranslate nohighlight">\(j\)</span>, we find optimal vertices <span class="math notranslate nohighlight">\(u^\ast \in S^{(j-1)}\)</span> and <span class="math notranslate nohighlight">\(v^\ast \in V \setminus S^{(j-1)}\)</span> in the sense that equation <a class="reference internal" href="#equation-eq-5">(1.5)</a> is satisfied. In doing so, we are guaranteed to find a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(V \setminus S^{(j-1)}\)</span> with the terminus <span class="math notranslate nohighlight">\(v^\ast\)</span>. Then we extend the set <span class="math notranslate nohighlight">\(S^{(j-1)}\)</span> to <span class="math notranslate nohighlight">\(S^{(j)}\)</span> by adding <span class="math notranslate nohighlight">\(v^\ast\)</span>.</p>
<p>Based on this idea, we propose our first attempt to find shortest paths in the following algorithm (<a class="reference internal" href="#alg:4">Algorithm 1.3</a>).</p>
<div class="proof algorithm admonition" id="alg:4">
<p class="admonition-title"><span class="caption-number">Algorithm 1.3 </span> (A First Attempt to Find the Shortest Paths)</p>
<div class="algorithm-content section" id="proof-content">
<img alt="A First Attempt to Find the Shortest Paths" class="align-center" src="../_images/2e3cd4c67a48aeadecc12d65ea64e787d2747149aadb76a7649eaaf12011d5ea.png" />
</div>
</div></div>
<div class="section" id="dijkstra-s-algorithm">
<h2><span class="section-number">1.5.2. </span>Dijkstra’s Algorithm<a class="headerlink" href="#dijkstra-s-algorithm" title="Permalink to this headline">#</a></h2>
<div class="proof algorithm admonition" id="alg:3">
<p class="admonition-title"><span class="caption-number">Algorithm 1.4 </span> (Dijkstra’s Algorithm)</p>
<div class="algorithm-content section" id="proof-content">
<img alt="Dijkstra's Algorithm" class="align-center" src="../_images/8a334f74f59c4cb150182d8a0c1761c13287f02a3575febcbe6fe8db9e35cca4.png" />
</div>
</div><p>Given a vertex <span class="math notranslate nohighlight">\(v\)</span>, its predecessor is given by <span class="math notranslate nohighlight">\(\Pi[v]\)</span>. And the predecessor of <span class="math notranslate nohighlight">\(\Pi[v]\)</span> is <span class="math notranslate nohighlight">\(\Pi[ \Pi[v] ]\)</span>, and so forth. We can keep accessing the predecessors until hopefully stops at the source <span class="math notranslate nohighlight">\(u_0\)</span>. In this case, we have recovered a path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(u_0 \cdots \Pi[v] v\)</span>. To make our proof concise, we call this procedure <em>recovering a <span class="math notranslate nohighlight">\((u_0, v)\)</span>-path using <span class="math notranslate nohighlight">\(\Pi\)</span></em>.</p>
<div class="proof admonition" id="proof">
<p>Proof. Note that there is an early return in line 22. Hence, we may not complete all <span class="math notranslate nohighlight">\(n-1\)</span> iterations of the for loop (lines 7-23). Suppose we can complete <span class="math notranslate nohighlight">\(k\)</span> iterations.</p>
<p><strong>Loop Invariants:</strong> Upon completion of the <span class="math notranslate nohighlight">\(j\)</span>-th iteration, we claim that</p>
<ul class="simple">
<li><p>➀ <span class="math notranslate nohighlight">\(D[u] = d(u_0, u) \quad \forall u \in S^{(j)}\)</span>,</p></li>
<li><p>➁ <span class="math notranslate nohighlight">\(D[v] = \min_{u \in S^{(j-1)}} \{ d(u_0, u) + w(u v) \} \quad \forall v \in V \setminus S^{(j)}\)</span>,</p></li>
<li><p>➂ we can recover a <span class="math notranslate nohighlight">\((u_0, u)\)</span>-path using <span class="math notranslate nohighlight">\(\Pi\)</span> for every <span class="math notranslate nohighlight">\(u \in S^{(j)}\)</span>, and</p></li>
<li><p>➃ <span class="math notranslate nohighlight">\(S^{(j)} = S^{(j-1)} \uplus u^{(j)}\)</span>.</p></li>
</ul>
<p><strong>Maintenance:</strong> Assuming all loop invariants hold for <span class="math notranslate nohighlight">\(j-1\)</span>. We now consider the <span class="math notranslate nohighlight">\(j\)</span>-th iteration. In the inner loop (lines 10-20), by referring to loop invariant 2, we note that the procedure from line 11 to line 15 ensures that</p>
<div class="math notranslate nohighlight" id="equation-eq-6">
<span class="eqno">(1.7)<a class="headerlink" href="#equation-eq-6" title="Permalink to this equation">#</a></span>\[\begin{align}
D[v] = \min\left\{\min_{u \in S^{(j-2)}}\{ d(u_0, u) + w(u v) \},
D[u^{(j-1)}] + w(u^{(j-1)} v)
\right\}\quad\forall v \in V \setminus S^{(j-1)}\end{align}\]</div>
<p>after this inner loop is completed. But invariant 1 implies that <span class="math notranslate nohighlight">\(D[u^{(j-1)}] = d(u_0, u^{(j-1)})\)</span>. Moreover, we have <span class="math notranslate nohighlight">\(S^{(j-1)} = S^{(j-2)} \uplus u^{(j-1)}\)</span> by invariant 4. Hence, <a class="reference internal" href="#equation-eq-6">(1.7)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-eq-7">
<span class="eqno">(1.8)<a class="headerlink" href="#equation-eq-7" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{multline}
D[v] = \min\left\{\min_{u \in S^{(j-2)}}\{ d(u_0, u) + w(u v) \},
d(u_0, u^{(j-1)}) + w(u^{(j-1)} v)
\right\}\\
= \min_{u \in S^{(j-1)}}\{ d(u_0, u) + w(u v) \}\quad\forall v \in V \setminus S^{(j-1)}\end{multline}\end{split}\]</div>
<p>Note that invariant 2 for iteration <span class="math notranslate nohighlight">\(j\)</span> follows directly from <a class="reference internal" href="#equation-eq-7">(1.8)</a> because <span class="math notranslate nohighlight">\(V \setminus S^{(j)} \subseteq V \setminus S^{(j-1)}\)</span> by line 25 if line 25 is reachable in the current iteration. If line 25 is not reachable, which means the algorithm terminates at line 22, then there is nothing to prove for this iteration.</p>
<p>The purpose of lines 16-19 is that upon completion of lines 10-20, we have</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
d^\ast = \min_{v \in V \setminus S^{(j-1)}}\min_{u \in S^{(j-1)}}\{ d(u_0, u) + w(u v) \}\end{align*}\]</div>
<p>By <a class="reference internal" href="#pro:2">Proposition 1.7</a>, we know <span class="math notranslate nohighlight">\(d^\ast\)</span> is the length of a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(V \setminus S^{(j-1)}\)</span>, that is,</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
d^\ast = d(u_0, V \setminus S^{(j-1)})
\end{align*}\]</div>
<p>We are now at the end of line 20. There are two cases.</p>
<p>(Case 1: Early Return) If <span class="math notranslate nohighlight">\(d^\ast = \infty\)</span> or equivalently <span class="math notranslate nohighlight">\(d(u_0, V \setminus S^{(j-1)}) = \infty\)</span>, then it means that <span class="math notranslate nohighlight">\(u_0\)</span> is disconnected from <span class="math notranslate nohighlight">\(V \setminus S^{(j-1)}\)</span>. Since no shortest paths are to be discovered, the algorithm needs to terminate. Recall we assume we can only complete <span class="math notranslate nohighlight">\(k\)</span> iterations. Therefore, the current iteration must be <span class="math notranslate nohighlight">\(k+1\)</span> for we are exiting the algorithm. No loop invariants need to be proved since this iteration is not completed.</p>
<p>(Case 2) On the other hand, we now suppose <span class="math notranslate nohighlight">\(v^\ast\)</span> is some vertex at the end of line 20. Let <span class="math notranslate nohighlight">\(u^{(j)} = v^\ast\)</span>(line 24). Then invariant 4 for iteration <span class="math notranslate nohighlight">\(j\)</span> is proved immediately by line 25.</p>
<p>We now prove invariant 3 for <span class="math notranslate nohighlight">\(j\)</span>. Note that the predecessor of <span class="math notranslate nohighlight">\(u^{(j)}\)</span> is <span class="math notranslate nohighlight">\(u^{(j-1)}\)</span>, i.e., <span class="math notranslate nohighlight">\(\Pi[u^{(j)}] = u^{(j-1)}\)</span> by line 14. We then recover a <span class="math notranslate nohighlight">\((u_0, u^{(j-1)})\)</span>-path, say <span class="math notranslate nohighlight">\(P\)</span>, using <span class="math notranslate nohighlight">\(\Pi\)</span>(invariant 3 for <span class="math notranslate nohighlight">\(j-1\)</span>). Note that <span class="math notranslate nohighlight">\(P u^{(j)}\)</span> is a <span class="math notranslate nohighlight">\((u_0, u^{(j)})\)</span>-path, and it can be recovered using <span class="math notranslate nohighlight">\(\Pi\)</span> since <span class="math notranslate nohighlight">\(\Pi[u^{(j)}] = u^{(j-1)}\)</span> and <span class="math notranslate nohighlight">\(P\)</span> itself is recovered using <span class="math notranslate nohighlight">\(\Pi\)</span>. This proves invariant 3 of iteration <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>Furthermore, by recalling <span class="math notranslate nohighlight">\(u^{(j)} = v^\ast\)</span> and <span class="math notranslate nohighlight">\(d^\ast = d(u_0, V \setminus S^{(j-1)})\)</span>, we note that <span class="math notranslate nohighlight">\(P u^{(j)}\)</span> is a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(u^{(j)}\)</span> since its length is <span class="math notranslate nohighlight">\(d(u_0, V \setminus S^{(j-1)})\)</span>. In other words, it is also a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(V \setminus S^{(j-1)}\)</span>. Therefore, we can write</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
d(u_0, u^{(j)}) = d^\ast = D[v^\ast]\end{align*}\]</div>
<p>where the last equality follows from line 18. Replacing <span class="math notranslate nohighlight">\(v^\ast\)</span> with <span class="math notranslate nohighlight">\(u^{(j)}\)</span>, equivalently we have</p>
<div class="math notranslate nohighlight" id="equation-eq-8">
<span class="eqno">(1.9)<a class="headerlink" href="#equation-eq-8" title="Permalink to this equation">#</a></span>\[\begin{align}
D[u^{(j)}] = d(u_0, u^{(j)})
\end{align}\]</div>
<p>This equation <a class="reference internal" href="#equation-eq-8">(1.9)</a> along with invariant 1 for <span class="math notranslate nohighlight">\(j-1\)</span> implies that invariant 1 also holds for <span class="math notranslate nohighlight">\(j\)</span>. Note that we have shown that all loop invariants are preserved when the current iteration (iteration <span class="math notranslate nohighlight">\(j\)</span>) is completed.</p>
<p><strong>Termination:</strong> As the algorithm terminates, there are <span class="math notranslate nohighlight">\(k+1\)</span> vertices in <span class="math notranslate nohighlight">\(S^{(k)}\)</span>. And the vertices outside <span class="math notranslate nohighlight">\(S^{(k)}\)</span> are not reachable from the source <span class="math notranslate nohighlight">\(u_0\)</span>. For each <span class="math notranslate nohighlight">\(u \in S^{(k)}\)</span>, we have <span class="math notranslate nohighlight">\(D[u] = d(u_0, u)\)</span>(invariant 1), that is, <span class="math notranslate nohighlight">\(D[u]\)</span> stores the length of a shortest path from <span class="math notranslate nohighlight">\(u_0\)</span> to <span class="math notranslate nohighlight">\(u\)</span>, as desired. And by invariant 3, we can recover a shortest <span class="math notranslate nohighlight">\((u_0, u)\)</span>-path using <span class="math notranslate nohighlight">\(\Pi\)</span>. This completes the proof.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "Isaac-Fate/graph-theory",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Basic Concepts of Graphs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Cycles.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1.4. </span>Cycles</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Trees/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Trees</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Isaac FEI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>